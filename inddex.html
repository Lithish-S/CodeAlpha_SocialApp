<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocialHub - CodeAlpha Social Media Platform</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4e73df;
            --success: #1cc88a;
            --info: #36b9cc;
            --warning: #f6c23e;
            --danger: #e74a3b;
            --dark: #5a5c69;
            --light: #f8f9fc;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary) 0%, #224abe 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: 800;
            font-size: 1.8rem;
            letter-spacing: 1px;
        }
        
        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white;
        }
        
        .profile-avatar-lg {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary);
        }
        
        .post-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
        }
        
        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .post-header {
            display: flex;
            align-items: center;
            padding: 20px 20px 0 20px;
        }
        
        .post-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }
        
        .post-content {
            padding: 15px 20px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .post-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            margin-top: 15px;
            border-radius: 10px;
        }
        
        .post-actions {
            padding: 15px 20px 20px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-around;
        }
        
        .post-action-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 1.1rem;
            padding: 8px 20px;
            border-radius: 30px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .post-action-btn:hover {
            background: #f0f2f5;
            color: var(--primary);
        }
        
        .post-action-btn.liked {
            color: var(--danger);
        }
        
        .post-action-btn.liked i {
            font-weight: 900;
        }
        
        .comment-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 0 0 15px 15px;
            border-top: 1px solid #eee;
        }
        
        .comment {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .comment-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .comment-content {
            background: white;
            padding: 10px 15px;
            border-radius: 18px;
            flex: 1;
        }
        
        .comment-author {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .comment-text {
            margin-bottom: 5px;
            font-size: 0.95rem;
        }
        
        .comment-time {
            font-size: 0.75rem;
            color: #999;
        }
        
        .create-post-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .create-post-input {
            border: none;
            background: #f0f2f5;
            padding: 15px;
            border-radius: 30px;
            width: 100%;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .create-post-input:focus {
            outline: none;
            background: #e4e6e9;
        }
        
        .sidebar-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }
        
        .friend-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .friend-item:last-child {
            border-bottom: none;
        }
        
        .friend-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            margin-right: 12px;
            object-fit: cover;
        }
        
        .friend-info {
            flex: 1;
        }
        
        .friend-name {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .friend-mutual {
            font-size: 0.8rem;
            color: #999;
        }
        
        .follow-btn {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        .profile-header {
            background: linear-gradient(135deg, var(--primary), #224abe);
            color: white;
            padding: 60px 0 30px;
            margin-bottom: 30px;
            border-radius: 0 0 30px 30px;
        }
        
        .profile-stats {
            display: flex;
            gap: 40px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .profile-stat-item {
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .profile-stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var-danger;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.7rem;
        }
        
        .search-box {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            color: white;
            width: 300px;
        }
        
        .search-box::placeholder {
            color: rgba(255,255,255,0.8);
        }
        
        .toast-container {
            z-index: 9999;
        }
        
        .login-container {
            max-width: 500px;
            margin: 50px auto;
        }
        
        .demo-account-btn {
            transition: all 0.2s;
        }
        
        .demo-account-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container position-fixed bottom-0 end-0 p-3"></div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showPage('feed')">
                <i class="fas fa-hashtag me-2"></i>SocialHub
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showPage('feed')">
                            <i class="fas fa-home me-1"></i> Feed
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('explore')">
                            <i class="fas fa-compass me-1"></i> Explore
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('notifications')">
                            <i class="fas fa-bell me-1"></i> Notifications
                            <span id="notificationBadge" class="badge bg-danger ms-1 d-none">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('messages')">
                            <i class="fas fa-envelope me-1"></i> Messages
                            <span id="messageBadge" class="badge bg-danger ms-1 d-none">2</span>
                        </a>
                    </li>
                </ul>
                
                <div class="d-flex me-3">
                    <input type="text" id="searchInput" class="search-box" placeholder="Search people, posts..." onkeyup="searchGlobal(event)">
                </div>
                
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <img id="navAvatar" src="https://via.placeholder.com/40" alt="Avatar" class="profile-avatar me-2">
                            <span id="navUserName">Guest</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" onclick="showPage('profile')">
                                <i class="fas fa-user me-2"></i> My Profile
                            </a></li>
                            <li><a class="dropdown-item" href="#" onclick="showPage('profileEdit')">
                                <i class="fas fa-cog me-2"></i> Settings
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="showLoginPage()">
                                <i class="fas fa-exchange-alt me-2"></i> Switch Account
                            </a></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">
                                <i class="fas fa-sign-out-alt me-2"></i> Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content Container -->
    <div class="container mt-4" id="mainContent">
        <!-- FEED PAGE -->
        <div id="feedPage">
            <div class="row">
                <!-- Left Sidebar - User Info -->
                <div class="col-lg-3">
                    <div class="sidebar-card">
                        <div class="text-center">
                            <img id="sidebarAvatar" src="https://via.placeholder.com/120" alt="Profile" class="profile-avatar-lg mb-3">
                            <h4 id="sidebarName">Guest User</h4>
                            <p id="sidebarBio" class="text-muted">Welcome to SocialHub! Connect with friends and share your moments.</p>
                            
                            <div class="profile-stats mb-3">
                                <div class="profile-stat-item">
                                    <div id="sidebarPosts" class="profile-stat-value">0</div>
                                    <div class="profile-stat-label">Posts</div>
                                </div>
                                <div class="profile-stat-item">
                                    <div id="sidebarFollowers" class="profile-stat-value">0</div>
                                    <div class="profile-stat-label">Followers</div>
                                </div>
                                <div class="profile-stat-item">
                                    <div id="sidebarFollowing" class="profile-stat-value">0</div>
                                    <div class="profile-stat-label">Following</div>
                                </div>
                            </div>
                            
                            <button class="btn btn-outline-primary w-100" onclick="showPage('profile')">
                                <i class="fas fa-user-edit me-2"></i> Edit Profile
                            </button>
                        </div>
                    </div>
                    
                    <div class="sidebar-card">
                        <h5 class="sidebar-title">Suggested Friends</h5>
                        <div id="suggestedFriends">
                            <!-- Suggested friends will load here -->
                        </div>
                        <button class="btn btn-link w-100 mt-2" onclick="showPage('explore')">
                            View More <i class="fas fa-arrow-right ms-1"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Main Feed - Create Post & Posts -->
                <div class="col-lg-6">
                    <!-- Create Post -->
                    <div class="create-post-card">
                        <div class="d-flex align-items-start">
                            <img id="createPostAvatar" src="https://via.placeholder.com/50" alt="Avatar" class="post-avatar">
                            <div class="flex-grow-1">
                                <textarea id="postContent" class="create-post-input" rows="2" placeholder="What's on your mind?"></textarea>
                                
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <button class="btn btn-outline-primary btn-sm me-2" onclick="document.getElementById('postImageInput').click()">
                                            <i class="fas fa-image me-1"></i> Photo
                                        </button>
                                        <input type="file" id="postImageInput" accept="image/*" style="display: none;" onchange="previewPostImage(event)">
                                        <button class="btn btn-outline-success btn-sm me-2">
                                            <i class="fas fa-video me-1"></i> Video
                                        </button>
                                        <button class="btn btn-outline-warning btn-sm">
                                            <i class="fas fa-smile me-1"></i> Feeling
                                        </button>
                                    </div>
                                    <button class="btn btn-primary" onclick="createPost()">
                                        <i class="fas fa-paper-plane me-1"></i> Post
                                    </button>
                                </div>
                                
                                <!-- Image Preview -->
                                <div id="postImagePreview" class="mt-3 d-none">
                                    <div class="position-relative">
                                        <img id="postPreviewImg" src="" alt="Preview" style="max-width: 100%; max-height: 300px; border-radius: 10px;">
                                        <button class="btn btn-sm btn-danger position-absolute top-0 end-0 m-2" onclick="clearPostImage()">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Posts Feed -->
                    <div id="postsContainer">
                        <!-- Posts will load here -->
                    </div>
                </div>
                
                <!-- Right Sidebar - Trending & Events -->
                <div class="col-lg-3">
                    <div class="sidebar-card">
                        <h5 class="sidebar-title">Trending Topics</h5>
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="badge bg-primary me-2">1</span>
                                    <strong>#CodeAlpha</strong>
                                </div>
                                <span class="text-muted">2.5k posts</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="badge bg-primary me-2">2</span>
                                    <strong>#WebDevelopment</strong>
                                </div>
                                <span class="text-muted">1.8k posts</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="badge bg-primary me-2">3</span>
                                    <strong>#JavaScript</strong>
                                </div>
                                <span class="text-muted">1.2k posts</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="badge bg-primary me-2">4</span>
                                    <strong>#ReactJS</strong>
                                </div>
                                <span class="text-muted">956 posts</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-primary me-2">5</span>
                                    <strong>#FullStack</strong>
                                </div>
                                <span class="text-muted">789 posts</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sidebar-card">
                        <h5 class="sidebar-title">Upcoming Events</h5>
                        <div class="mb-3">
                            <div class="d-flex align-items-center mb-3">
                                <div class="bg-primary text-white rounded p-2 me-3 text-center" style="width: 50px;">
                                    <div class="small">FEB</div>
                                    <div class="fw-bold">25</div>
                                </div>
                                <div>
                                    <h6 class="mb-0">CodeAlpha Hackathon</h6>
                                    <small class="text-muted">Online · 2:00 PM</small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <div class="bg-success text-white rounded p-2 me-3 text-center" style="width: 50px;">
                                    <div class="small">MAR</div>
                                    <div class="fw-bold">01</div>
                                </div>
                                <div>
                                    <h6 class="mb-0">Tech Meetup 2024</h6>
                                    <small class="text-muted">New York · 6:00 PM</small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center">
                                <div class="bg-info text-white rounded p-2 me-3 text-center" style="width: 50px;">
                                    <div class="small">MAR</div>
                                    <div class="fw-bold">15</div>
                                </div>
                                <div>
                                    <h6 class="mb-0">Web Dev Workshop</h6>
                                    <small class="text-muted">Online · 11:00 AM</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PROFILE PAGE -->
        <div id="profilePage" class="d-none">
            <div class="profile-header">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-3 text-center">
                            <img id="profileAvatar" src="https://via.placeholder.com/150" alt="Profile" class="profile-avatar-lg mb-3" style="width: 150px; height: 150px;">
                        </div>
                        <div class="col-lg-6">
                            <h2 id="profileFullName">John Doe</h2>
                            <p id="profileUserBio" class="mb-2">Web Developer | Tech Enthusiast | CodeAlpha Intern</p>
                            <p id="profileLocation" class="mb-3">
                                <i class="fas fa-map-marker-alt me-2"></i> New York, USA
                                <span class="ms-3"><i class="fas fa-calendar-alt me-2"></i> Joined March 2023</span>
                            </p>
                        </div>
                        <div class="col-lg-3 text-lg-end">
                            <button class="btn btn-light me-2" onclick="showPage('profileEdit')">
                                <i class="fas fa-edit me-2"></i> Edit Profile
                            </button>
                            <button class="btn btn-outline-light" onclick="shareProfile()">
                                <i class="fas fa-share-alt me-2"></i> Share
                            </button>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="profile-stat-item">
                            <div id="profilePostCount" class="profile-stat-value">0</div>
                            <div class="profile-stat-label">Posts</div>
                        </div>
                        <div class="profile-stat-item">
                            <div id="profileFollowerCount" class="profile-stat-value">0</div>
                            <div class="profile-stat-label">Followers</div>
                        </div>
                        <div class="profile-stat-item">
                            <div id="profileFollowingCount" class="profile-stat-value">0</div>
                            <div class="profile-stat-label">Following</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="container mt-4">
                <div class="row">
                    <div class="col-lg-3">
                        <div class="sidebar-card">
                            <h5 class="sidebar-title">About</h5>
                            <p id="profileAbout">Passionate web developer currently interning at CodeAlpha. Love building cool projects and learning new technologies.</p>
                            
                            <hr>
                            
                            <div class="mb-2">
                                <i class="fas fa-briefcase me-2 text-primary"></i> 
                                <span id="profileWork">Frontend Developer at TechCorp</span>
                            </div>
                            <div class="mb-2">
                                <i class="fas fa-graduation-cap me-2 text-primary"></i> 
                                <span id="profileEducation">B.Sc. Computer Science</span>
                            </div>
                            <div>
                                <i class="fas fa-heart me-2 text-primary"></i> 
                                <span id="profileHobbies">Coding, Photography, Travel</span>
                            </div>
                        </div>
                        
                        <div class="sidebar-card">
                            <h5 class="sidebar-title">Photos</h5>
                            <div class="row g-2" id="profilePhotos">
                                <div class="col-4">
                                    <img src="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=100" class="img-fluid rounded" alt="Photo">
                                </div>
                                <div class="col-4">
                                    <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=100" class="img-fluid rounded" alt="Photo">
                                </div>
                                <div class="col-4">
                                    <img src="https://images.unsplash.com/photo-1518770660439-4636190af475?w=100" class="img-fluid rounded" alt="Photo">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <ul class="nav nav-pills mb-4" id="profileTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="posts-tab" data-bs-toggle="tab" data-bs-target="#userPosts">Posts</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="media-tab" data-bs-toggle="tab" data-bs-target="#userMedia">Media</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="likes-tab" data-bs-toggle="tab" data-bs-target="#userLikes">Likes</button>
                            </li>
                        </ul>
                        
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="userPosts">
                                <div id="userPostsContainer">
                                    <!-- User posts will load here -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="userMedia">
                                <div class="row g-3" id="userMediaContainer">
                                    <!-- User media will load here -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="userLikes">
                                <div id="userLikesContainer">
                                    <!-- Liked posts will load here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-3">
                        <div class="sidebar-card">
                            <h5 class="sidebar-title">Followers</h5>
                            <div id="followersList">
                                <!-- Followers will load here -->
                            </div>
                        </div>
                        
                        <div class="sidebar-card">
                            <h5 class="sidebar-title">Following</h5>
                            <div id="followingList">
                                <!-- Following will load here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PROFILE EDIT PAGE -->
        <div id="profileEditPage" class="d-none">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card shadow">
                        <div class="card-header bg-primary text-white">
                            <h4 class="mb-0"><i class="fas fa-user-edit me-2"></i> Edit Profile</h4>
                        </div>
                        <div class="card-body p-4">
                            <form id="profileEditForm">
                                <div class="text-center mb-4">
                                    <img id="editAvatar" src="https://via.placeholder.com/120" alt="Avatar" class="profile-avatar-lg mb-3">
                                    <div>
                                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="document.getElementById('avatarInput').click()">
                                            <i class="fas fa-camera me-2"></i> Change Photo
                                        </button>
                                        <input type="file" id="avatarInput" accept="image/*" style="display: none;" onchange="updateAvatarPreview(event)">
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">First Name</label>
                                        <input type="text" class="form-control" id="editFirstName" value="John">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Last Name</label>
                                        <input type="text" class="form-control" id="editLastName" value="Doe">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Bio</label>
                                    <textarea class="form-control" id="editBio" rows="3">Web Developer | Tech Enthusiast | CodeAlpha Intern</textarea>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Location</label>
                                    <input type="text" class="form-control" id="editLocation" value="New York, USA">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Work</label>
                                    <input type="text" class="form-control" id="editWork" value="Frontend Developer at TechCorp">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Education</label>
                                    <input type="text" class="form-control" id="editEducation" value="B.Sc. Computer Science">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Hobbies/Interests</label>
                                    <input type="text" class="form-control" id="editHobbies" value="Coding, Photography, Travel">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" id="editEmail" value="john.doe@example.com" readonly>
                                    <small class="text-muted">Email cannot be changed</small>
                                </div>
                                
                                <hr>
                                
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-secondary" onclick="showPage('profile')">
                                        Cancel
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-2"></i> Save Changes
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- LOGIN PAGE (SWITCH ACCOUNT) -->
        <div id="loginPage" class="d-none">
            <div class="login-container">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-header bg-primary text-white text-center py-4">
                        <h3 class="mb-0"><i class="fas fa-exchange-alt me-2"></i>Switch Account</h3>
                    </div>
                    <div class="card-body p-4">
                        <form id="loginForm">
                            <div class="mb-3">
                                <label class="form-label">Email Address</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                    <input type="email" class="form-control" id="loginEmail" placeholder="Enter email" value="john@example.com" required>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                    <input type="password" class="form-control" id="loginPassword" placeholder="Enter password" value="password123" required>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-sign-in-alt me-2"></i> Login
                                </button>
                            </div>
                        </form>
                        
                        <hr class="my-4">
                        
                        <h6 class="text-center mb-3">Quick Switch - One Click Login</h6>
                        <div class="row g-2">
                            <div class="col-6">
                                <button class="btn btn-outline-primary w-100 demo-account-btn mb-2" onclick="quickLogin('john@example.com', 'password123')">
                                    <img src="https://randomuser.me/api/portraits/men/32.jpg" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 5px;"> John
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-outline-success w-100 demo-account-btn mb-2" onclick="quickLogin('jane@example.com', 'password123')">
                                    <img src="https://randomuser.me/api/portraits/women/44.jpg" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 5px;"> Jane
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-outline-warning w-100 demo-account-btn mb-2" onclick="quickLogin('mike@example.com', 'password123')">
                                    <img src="https://randomuser.me/api/portraits/men/67.jpg" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 5px;"> Mike
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-outline-info w-100 demo-account-btn mb-2" onclick="quickLogin('sarah@example.com', 'password123')">
                                    <img src="https://randomuser.me/api/portraits/women/68.jpg" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 5px;"> Sarah
                                </button>
                            </div>
                            <div class="col-12">
                                <button class="btn btn-outline-danger w-100 demo-account-btn" onclick="quickLogin('admin@socialhub.com', 'admin123')">
                                    <img src="https://randomuser.me/api/portraits/men/1.jpg" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 5px;"> Admin
                                </button>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <p class="mb-2">Don't have an account?</p>
                            <button class="btn btn-success w-100" onclick="showCreateAccountPage()">
                                <i class="fas fa-user-plus me-2"></i> Create New Account
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CREATE ACCOUNT PAGE -->
        <div id="createAccountPage" class="d-none">
            <div class="login-container">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-header bg-success text-white text-center py-4">
                        <h3 class="mb-0"><i class="fas fa-user-plus me-2"></i>Create Account</h3>
                    </div>
                    <div class="card-body p-4">
                        <form id="createAccountForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">First Name</label>
                                    <input type="text" class="form-control" id="newFirstName" placeholder="John" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Last Name</label>
                                    <input type="text" class="form-control" id="newLastName" placeholder="Doe" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Email Address</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                    <input type="email" class="form-control" id="newEmail" placeholder="your@email.com" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                    <input type="password" class="form-control" id="newPassword" placeholder="Min. 6 characters" required>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="form-label">Confirm Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                    <input type="password" class="form-control" id="confirmPassword" placeholder="Re-enter password" required>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-success btn-lg">
                                    <i class="fas fa-user-plus me-2"></i> Create Account
                                </button>
                            </div>
                        </form>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <p class="mb-0">Already have an account?</p>
                            <button class="btn btn-link" onclick="showLoginPage()">
                                <i class="fas fa-sign-in-alt me-1"></i> Sign In Here
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXPLORE PAGE -->
        <div id="explorePage" class="d-none">
            <div class="row">
                <div class="col-12 mb-4">
                    <h2 class="mb-4">Explore</h2>
                </div>
                
                <div class="col-lg-8">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="card">
                                <div class="card-header bg-white">
                                    <h5 class="mb-0">Discover People</h5>
                                </div>
                                <div class="card-body">
                                    <div id="exploreUsers" class="row">
                                        <!-- Explore users will load here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header bg-white">
                                    <h5 class="mb-0">Popular Posts</h5>
                                </div>
                                <div class="card-body">
                                    <div id="explorePosts">
                                        <!-- Explore posts will load here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4">
                    <div class="sidebar-card">
                        <h5 class="sidebar-title">Trending Hashtags</h5>
                        <div id="trendingHashtags">
                            <div class="mb-3">
                                <span class="badge bg-primary me-2">#CodeAlpha</span>
                                <small class="text-muted">2.5k posts</small>
                            </div>
                            <div class="mb-3">
                                <span class="badge bg-success me-2">#WebDev</span>
                                <small class="text-muted">1.8k posts</small>
                            </div>
                            <div class="mb-3">
                                <span class="badge bg-info me-2">#JavaScript</span>
                                <small class="text-muted">1.2k posts</small>
                            </div>
                            <div class="mb-3">
                                <span class="badge bg-warning me-2">#React</span>
                                <small class="text-muted">956 posts</small>
                            </div>
                            <div class="mb-3">
                                <span class="badge bg-danger me-2">#FullStack</span>
                                <small class="text-muted">789 posts</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- NOTIFICATIONS PAGE -->
        <div id="notificationsPage" class="d-none">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-bell me-2 text-primary"></i> Notifications</h5>
                            <button class="btn btn-sm btn-outline-primary" onclick="markAllNotificationsRead()">
                                Mark all as read
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="notificationsContainer">
                                <!-- Notifications will load here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MESSAGES PAGE -->
        <div id="messagesPage" class="d-none">
            <div class="row">
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Conversations</h5>
                        </div>
                        <div class="card-body p-0">
                            <div id="conversationsList" class="list-group list-group-flush">
                                <!-- Conversations will load here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header bg-white">
                            <div class="d-flex align-items-center" id="messageHeader">
                                <img src="https://via.placeholder.com/40" class="profile-avatar me-2" alt="User">
                                <div>
                                    <h6 class="mb-0">Select a conversation</h6>
                                </div>
                            </div>
                        </div>
                        <div class="card-body" style="min-height: 400px;" id="messageBody">
                            <div class="text-center text-muted py-5">
                                <i class="fas fa-comments fa-3x mb-3"></i>
                                <p>Select a conversation to start messaging</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEARCH RESULTS PAGE -->
        <div id="searchResultsPage" class="d-none">
            <div class="row">
                <div class="col-12 mb-4">
                    <h4>Search Results for: "<span id="searchQuery"></span>"</h4>
                </div>
                
                <div class="col-lg-8">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">People</h5>
                        </div>
                        <div class="card-body">
                            <div id="searchPeopleResults">
                                <!-- Search results will load here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Posts</h5>
                        </div>
                        <div class="card-body">
                            <div id="searchPostsResults">
                                <!-- Search posts will load here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ======================
        // SAMPLE DATA
        // ======================
        
        const sampleUsers = [
            {
                id: 1,
                firstName: "Admin",
                lastName: "User",
                fullName: "Admin User",
                email: "admin@socialhub.com",
                password: "admin123",
                bio: "Platform Administrator | CodeAlpha Mentor",
                avatar: "https://randomuser.me/api/portraits/men/1.jpg",
                location: "San Francisco, CA",
                work: "CodeAlpha",
                education: "Stanford University",
                hobbies: "Mentoring, Coding, Reading",
                joined: "2023-01-15",
                posts: 45,
                followers: 1234,
                following: 89,
                isAdmin: true
            },
            {
                id: 2,
                firstName: "John",
                lastName: "Doe",
                fullName: "John Doe",
                email: "john@example.com",
                password: "password123",
                bio: "Web Developer | Tech Enthusiast | CodeAlpha Intern",
                avatar: "https://randomuser.me/api/portraits/men/32.jpg",
                location: "New York, USA",
                work: "Frontend Developer at TechCorp",
                education: "B.Sc. Computer Science",
                hobbies: "Coding, Photography, Travel",
                joined: "2023-03-20",
                posts: 28,
                followers: 342,
                following: 156,
                isAdmin: false
            },
            {
                id: 3,
                firstName: "Jane",
                lastName: "Smith",
                fullName: "Jane Smith",
                email: "jane@example.com",
                password: "password123",
                bio: "UX Designer | Creative Thinker",
                avatar: "https://randomuser.me/api/portraits/women/44.jpg",
                location: "London, UK",
                work: "Design Lead at CreativeStudio",
                education: "MA Design",
                hobbies: "Art, Music, Travel",
                joined: "2023-04-10",
                posts: 52,
                followers: 567,
                following: 203,
                isAdmin: false
            },
            {
                id: 4,
                firstName: "Mike",
                lastName: "Johnson",
                fullName: "Mike Johnson",
                email: "mike@example.com",
                password: "password123",
                bio: "Full Stack Developer | Open Source Contributor",
                avatar: "https://randomuser.me/api/portraits/men/67.jpg",
                location: "Austin, TX",
                work: "Software Engineer at DevHub",
                education: "B.S. Software Engineering",
                hobbies: "Gaming, Hiking, Tech",
                joined: "2023-05-15",
                posts: 37,
                followers: 289,
                following: 178,
                isAdmin: false
            },
            {
                id: 5,
                firstName: "Sarah",
                lastName: "Wilson",
                fullName: "Sarah Wilson",
                email: "sarah@example.com",
                password: "password123",
                bio: "Digital Marketing Specialist | Content Creator",
                avatar: "https://randomuser.me/api/portraits/women/68.jpg",
                location: "Toronto, Canada",
                work: "Marketing Manager at BrandCo",
                education: "BBA Marketing",
                hobbies: "Writing, Photography, Yoga",
                joined: "2023-06-22",
                posts: 63,
                followers: 891,
                following: 234,
                isAdmin: false
            }
        ];

        const samplePosts = [
            {
                id: 1,
                userId: 2,
                userName: "John Doe",
                userAvatar: "https://randomuser.me/api/portraits/men/32.jpg",
                content: "Just finished my first full-stack project with React and Node.js! 🚀 Really excited about how it turned out. Check out my GitHub for the code! #CodeAlpha #WebDevelopment #ReactJS",
                image: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=800",
                likes: 45,
                likedBy: [3, 4, 5],
                comments: [
                    {
                        id: 1,
                        userId: 3,
                        userName: "Jane Smith",
                        userAvatar: "https://randomuser.me/api/portraits/women/44.jpg",
                        text: "Awesome work! The UI looks great! 🔥",
                        timestamp: "2024-02-10T14:30:00Z"
                    },
                    {
                        id: 2,
                        userId: 4,
                        userName: "Mike Johnson",
                        userAvatar: "https://randomuser.me/api/portraits/men/67.jpg",
                        text: "Congrats! Would love to see the code 👨‍💻",
                        timestamp: "2024-02-10T15:45:00Z"
                    }
                ],
                timestamp: "2024-02-10T10:30:00Z",
                isLiked: false
            },
            {
                id: 2,
                userId: 3,
                userName: "Jane Smith",
                userAvatar: "https://randomuser.me/api/portraits/women/44.jpg",
                content: "Beautiful morning for some UI design inspiration! 🎨 Working on a new mobile app interface. What do you think about this color scheme? #UXDesign #UI #DesignInspo",
                image: "https://images.unsplash.com/photo-1586717791821-3f44a563fa4c?w=800",
                likes: 78,
                likedBy: [2, 5],
                comments: [
                    {
                        id: 1,
                        userId: 2,
                        userName: "John Doe",
                        userAvatar: "https://randomuser.me/api/portraits/men/32.jpg",
                        text: "Love the minimalistic approach! Colors are perfect 👌",
                        timestamp: "2024-02-09T09:20:00Z"
                    }
                ],
                timestamp: "2024-02-09T08:15:00Z",
                isLiked: false
            },
            {
                id: 3,
                userId: 4,
                userName: "Mike Johnson",
                userAvatar: "https://randomuser.me/api/portraits/men/67.jpg",
                content: "Just contributed to my first open source project! 🎉 It's amazing to be part of such a supportive community. If you're new to open source, don't be afraid to start small! #OpenSource #GitHub #Coding",
                image: null,
                likes: 112,
                likedBy: [2, 3, 5],
                comments: [
                    {
                        id: 1,
                        userId: 5,
                        userName: "Sarah Wilson",
                        userAvatar: "https://randomuser.me/api/portraits/women/68.jpg",
                        text: "That's awesome! Which project did you contribute to?",
                        timestamp: "2024-02-08T16:30:00Z"
                    },
                    {
                        id: 2,
                        userId: 2,
                        userName: "John Doe",
                        userAvatar: "https://randomuser.me/api/portraits/men/32.jpg",
                        text: "Great job! Open source is the best way to learn 👍",
                        timestamp: "2024-02-08T17:45:00Z"
                    }
                ],
                timestamp: "2024-02-08T15:20:00Z",
                isLiked: false
            },
            {
                id: 4,
                userId: 5,
                userName: "Sarah Wilson",
                userAvatar: "https://randomuser.me/api/portraits/women/68.jpg",
                content: "Finally launched my personal blog! 📝 Writing about digital marketing, tech trends, and career tips. Link in bio! #Blogging #DigitalMarketing #CareerGrowth",
                image: "https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=800",
                likes: 67,
                likedBy: [2, 3, 4],
                comments: [
                    {
                        id: 1,
                        userId: 3,
                        userName: "Jane Smith",
                        userAvatar: "https://randomuser.me/api/portraits/women/44.jpg",
                        text: "Congrats on the launch! Will definitely check it out 💻",
                        timestamp: "2024-02-07T11:20:00Z"
                    }
                ],
                timestamp: "2024-02-07T10:00:00Z",
                isLiked: false
            }
        ];

        const sampleNotifications = [
            {
                id: 1,
                type: "like",
                userId: 3,
                userName: "Jane Smith",
                userAvatar: "https://randomuser.me/api/portraits/women/44.jpg",
                postId: 1,
                postContent: "Just finished my first full-stack project...",
                timestamp: "2024-02-10T14:30:00Z",
                read: false
            },
            {
                id: 2,
                type: "comment",
                userId: 4,
                userName: "Mike Johnson",
                userAvatar: "https://randomuser.me/api/portraits/men/67.jpg",
                postId: 1,
                comment: "Congrats! Would love to see the code 👨‍💻",
                timestamp: "2024-02-10T15:45:00Z",
                read: false
            },
            {
                id: 3,
                type: "follow",
                userId: 5,
                userName: "Sarah Wilson",
                userAvatar: "https://randomuser.me/api/portraits/women/68.jpg",
                timestamp: "2024-02-09T09:30:00Z",
                read: true
            }
        ];

        const sampleMessages = [
            {
                id: 1,
                userId: 3,
                userName: "Jane Smith",
                userAvatar: "https://randomuser.me/api/portraits/women/44.jpg",
                lastMessage: "Hey! How's the project going?",
                timestamp: "2024-02-10T16:20:00Z",
                unread: 2
            },
            {
                id: 2,
                userId: 4,
                userName: "Mike Johnson",
                userAvatar: "https://randomuser.me/api/portraits/men/67.jpg",
                lastMessage: "Thanks for the help!",
                timestamp: "2024-02-09T14:15:00Z",
                unread: 0
            }
        ];

        // ======================
        // INITIALIZATION
        // ======================
        
        function initializeStorage() {
            if (!localStorage.getItem('social_users')) {
                localStorage.setItem('social_users', JSON.stringify(sampleUsers));
            }
            
            if (!localStorage.getItem('social_posts')) {
                localStorage.setItem('social_posts', JSON.stringify(samplePosts));
            }
            
            if (!localStorage.getItem('social_notifications')) {
                localStorage.setItem('social_notifications', JSON.stringify(sampleNotifications));
            }
            
            if (!localStorage.getItem('social_messages')) {
                localStorage.setItem('social_messages', JSON.stringify(sampleMessages));
            }
            
            if (!localStorage.getItem('social_currentUser')) {
                // Auto login with John Doe for demo
                const johnDoe = sampleUsers.find(u => u.email === "john@example.com");
                const { password, ...userWithoutPassword } = johnDoe;
                localStorage.setItem('social_currentUser', JSON.stringify(userWithoutPassword));
            }
            
            if (!localStorage.getItem('social_followers')) {
                const followers = {
                    2: [3, 4, 5],
                    3: [2, 5],
                    4: [2, 3],
                    5: [2, 3, 4]
                };
                localStorage.setItem('social_followers', JSON.stringify(followers));
            }
            
            if (!localStorage.getItem('social_following')) {
                const following = {
                    2: [3, 4, 5],
                    3: [2, 4],
                    4: [2, 5],
                    5: [2, 3]
                };
                localStorage.setItem('social_following', JSON.stringify(following));
            }
        }

        // ======================
        // UTILITY FUNCTIONS
        // ======================
        
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toastId = 'toast-' + Date.now();
            
            const typeClass = {
                'success': 'bg-success text-white',
                'error': 'bg-danger text-white',
                'warning': 'bg-warning text-dark',
                'info': 'bg-info text-white'
            }[type] || 'bg-secondary text-white';
            
            const icon = {
                'success': 'fa-check-circle',
                'error': 'fa-exclamation-circle',
                'warning': 'fa-exclamation-triangle',
                'info': 'fa-info-circle'
            }[type] || 'fa-info-circle';
            
            const toast = document.createElement('div');
            toast.className = `toast align-items-center ${typeClass} border-0`;
            toast.id = toastId;
            toast.setAttribute('role', 'alert');
            toast.setAttribute('aria-live', 'assertive');
            toast.setAttribute('aria-atomic', 'true');
            
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="fas ${icon} me-2"></i> ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
            
            toast.addEventListener('hidden.bs.toast', function() {
                toast.remove();
            });
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            if (diffDays < 7) return `${diffDays}d ago`;
            
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function formatNumber(num) {
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'k';
            }
            return num;
        }

        // ======================
        // PAGE NAVIGATION
        // ======================
        
        function showPage(pageId) {
            const pages = ['feed', 'profile', 'profileEdit', 'explore', 'notifications', 'messages', 'searchResults', 'login', 'createAccount'];
            
            pages.forEach(page => {
                const element = document.getElementById(page + 'Page');
                if (element) {
                    element.classList.add('d-none');
                }
            });
            
            const pageToShow = document.getElementById(pageId + 'Page');
            if (pageToShow) {
                pageToShow.classList.remove('d-none');
                
                // Update active nav link
                document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                // Load page-specific content
                switch(pageId) {
                    case 'feed':
                        loadFeed();
                        document.querySelector('.navbar-nav .nav-link[onclick="showPage(\'feed\')"]')?.classList.add('active');
                        break;
                    case 'profile':
                        loadProfile();
                        break;
                    case 'profileEdit':
                        loadProfileEdit();
                        break;
                    case 'explore':
                        loadExplore();
                        document.querySelector('.navbar-nav .nav-link[onclick="showPage(\'explore\')"]')?.classList.add('active');
                        break;
                    case 'notifications':
                        loadNotifications();
                        document.querySelector('.navbar-nav .nav-link[onclick="showPage(\'notifications\')"]')?.classList.add('active');
                        break;
                    case 'messages':
                        loadMessages();
                        document.querySelector('.navbar-nav .nav-link[onclick="showPage(\'messages\')"]')?.classList.add('active');
                        break;
                }
            }
        }

        // ======================
        // AUTH FUNCTIONS
        // ======================
        
        function getCurrentUser() {
            return JSON.parse(localStorage.getItem('social_currentUser'));
        }

        function updateUserMenu() {
            const user = getCurrentUser();
            const navAvatar = document.getElementById('navAvatar');
            const navUserName = document.getElementById('navUserName');
            const sidebarAvatar = document.getElementById('sidebarAvatar');
            const sidebarName = document.getElementById('sidebarName');
            const sidebarBio = document.getElementById('sidebarBio');
            const createPostAvatar = document.getElementById('createPostAvatar');
            
            if (user) {
                navAvatar.src = user.avatar || 'https://via.placeholder.com/40';
                navUserName.textContent = user.firstName || 'User';
                
                sidebarAvatar.src = user.avatar || 'https://via.placeholder.com/120';
                sidebarName.textContent = user.fullName || `${user.firstName} ${user.lastName}`;
                sidebarBio.textContent = user.bio || 'Welcome to SocialHub!';
                
                createPostAvatar.src = user.avatar || 'https://via.placeholder.com/50';
                
                // Update post counts
                const posts = getPosts();
                const userPosts = posts.filter(p => p.userId === user.id);
                document.getElementById('sidebarPosts').textContent = userPosts.length;
                
                // Update followers/following counts
                const followers = getFollowers(user.id);
                const following = getFollowing(user.id);
                document.getElementById('sidebarFollowers').textContent = formatNumber(followers.length);
                document.getElementById('sidebarFollowing').textContent = formatNumber(following.length);
            }
        }

        function showLoginPage() {
            showPage('login');
        }

        function showCreateAccountPage() {
            showPage('createAccount');
        }

        function login(email, password) {
            const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                const { password, ...userWithoutPassword } = user;
                localStorage.setItem('social_currentUser', JSON.stringify(userWithoutPassword));
                
                updateUserMenu();
                showToast(`Welcome back, ${user.firstName}!`, 'success');
                showPage('feed');
                return true;
            } else {
                showToast('Invalid email or password', 'error');
                return false;
            }
        }

        function quickLogin(email, password) {
            login(email, password);
        }

        function logout() {
            showLoginPage();
            showToast('Please login to continue', 'info');
        }

        // ======================
        // CREATE ACCOUNT FUNCTION
        // ======================
        
        function createNewAccount(firstName, lastName, email, password) {
            // Get existing users
            const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
            
            // Check if email already exists
            if (users.find(u => u.email === email)) {
                showToast('Email already registered! Try logging in.', 'error');
                return false;
            }
            
            // Create new user
            const newUser = {
                id: users.length + 1,
                firstName: firstName,
                lastName: lastName,
                fullName: `${firstName} ${lastName}`,
                email: email,
                password: password,
                bio: "New to SocialHub! 🎉",
                avatar: `https://ui-avatars.com/api/?name=${firstName}+${lastName}&size=150&background=4e73df&color=fff`,
                location: "Not set",
                work: "Not set",
                education: "Not set",
                hobbies: "Exploring SocialHub",
                joined: new Date().toISOString().split('T')[0],
                posts: 0,
                followers: 0,
                following: 0,
                isAdmin: false
            };
            
            // Add to users array
            users.push(newUser);
            localStorage.setItem('social_users', JSON.stringify(users));
            
            // Auto login with new account
            const { password: pwd, ...userWithoutPassword } = newUser;
            localStorage.setItem('social_currentUser', JSON.stringify(userWithoutPassword));
            
            showToast('Account created successfully! 🎉', 'success');
            updateUserMenu();
            showPage('feed');
            return true;
        }

        // ======================
        // POST FUNCTIONS
        // ======================
        
        function getPosts() {
            return JSON.parse(localStorage.getItem('social_posts')) || [];
        }

        function savePosts(posts) {
            localStorage.setItem('social_posts', JSON.stringify(posts));
        }

        function loadFeed() {
            const posts = getPosts();
            const container = document.getElementById('postsContainer');
            const user = getCurrentUser();
            
            // Sort by timestamp (newest first)
            posts.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            if (posts.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-newspaper fa-4x text-muted mb-3"></i>
                        <h5>No posts yet</h5>
                        <p class="text-muted">Be the first to share something!</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            posts.forEach(post => {
                // Check if current user liked this post
                const isLiked = post.likedBy && post.likedBy.includes(user?.id);
                
                html += `
                    <div class="post-card" id="post-${post.id}">
                        <div class="post-header">
                            <img src="${post.userAvatar}" alt="${post.userName}" class="post-avatar">
                            <div>
                                <h6 class="mb-0">${post.userName}</h6>
                                <small class="text-muted">${formatDate(post.timestamp)}</small>
                            </div>
                        </div>
                        
                        <div class="post-content">
                            <p>${post.content}</p>
                            ${post.image ? `<img src="${post.image}" alt="Post image" class="post-image">` : ''}
                        </div>
                        
                        <div class="px-4 pb-2">
                            <span class="me-3"><i class="fas fa-heart text-danger me-1"></i> ${formatNumber(post.likes || 0)}</span>
                            <span><i class="fas fa-comment text-primary me-1"></i> ${formatNumber(post.comments?.length || 0)}</span>
                        </div>
                        
                        <div class="post-actions">
                            <button class="post-action-btn ${isLiked ? 'liked' : ''}" onclick="toggleLike(${post.id})">
                                <i class="fas ${isLiked ? 'fa-heart' : 'fa-heart'}"></i>
                                <span>${isLiked ? 'Liked' : 'Like'}</span>
                            </button>
                            <button class="post-action-btn" onclick="focusComment(${post.id})">
                                <i class="fas fa-comment"></i>
                                <span>Comment</span>
                            </button>
                            <button class="post-action-btn" onclick="sharePost(${post.id})">
                                <i class="fas fa-share"></i>
                                <span>Share</span>
                            </button>
                        </div>
                        
                        <div class="comment-section" id="comments-${post.id}" style="display: none;">
                            <div id="comments-list-${post.id}">
                                ${renderComments(post.comments || [])}
                            </div>
                            
                            <div class="d-flex mt-3">
                                <img src="${user?.avatar || 'https://via.placeholder.com/35'}" class="comment-avatar" alt="Avatar">
                                <div class="flex-grow-1">
                                    <input type="text" class="form-control form-control-sm" id="comment-input-${post.id}" placeholder="Write a comment..." onkeypress="handleCommentKeyPress(event, ${post.id})">
                                </div>
                                <button class="btn btn-primary btn-sm ms-2" onclick="addComment(${post.id})">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updateUserMenu();
        }

        function renderComments(comments) {
            if (!comments || comments.length === 0) {
                return '<p class="text-muted small text-center">No comments yet</p>';
            }
            
            return comments.map(comment => `
                <div class="comment">
                    <img src="${comment.userAvatar}" alt="${comment.userName}" class="comment-avatar">
                    <div class="comment-content">
                        <div class="comment-author">${comment.userName}</div>
                        <div class="comment-text">${comment.text}</div>
                        <div class="comment-time">${formatDate(comment.timestamp)}</div>
                    </div>
                </div>
            `).join('');
        }

        function createPost() {
            const user = getCurrentUser();
            if (!user) {
                showToast('Please login to post', 'warning');
                showLoginPage();
                return;
            }
            
            const content = document.getElementById('postContent').value.trim();
            if (!content) {
                showToast('Please write something to post!', 'warning');
                return;
            }
            
            const imagePreview = document.getElementById('postPreviewImg');
            const imageUrl = imagePreview.src && !imagePreview.src.includes('placeholder') ? imagePreview.src : null;
            
            const newPost = {
                id: Date.now(),
                userId: user.id,
                userName: user.fullName || `${user.firstName} ${user.lastName}`,
                userAvatar: user.avatar || 'https://via.placeholder.com/50',
                content: content,
                image: imageUrl,
                likes: 0,
                likedBy: [],
                comments: [],
                timestamp: new Date().toISOString()
            };
            
            const posts = getPosts();
            posts.push(newPost);
            savePosts(posts);
            
            // Clear form
            document.getElementById('postContent').value = '';
            clearPostImage();
            
            showToast('Post created successfully!', 'success');
            loadFeed();
        }

        function previewPostImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('postImagePreview');
                    const img = document.getElementById('postPreviewImg');
                    img.src = e.target.result;
                    preview.classList.remove('d-none');
                };
                reader.readAsDataURL(file);
            }
        }

        function clearPostImage() {
            document.getElementById('postImagePreview').classList.add('d-none');
            document.getElementById('postPreviewImg').src = '';
            document.getElementById('postImageInput').value = '';
        }

        function toggleLike(postId) {
            const user = getCurrentUser();
            if (!user) {
                showToast('Please login to like posts', 'warning');
                showLoginPage();
                return;
            }
            
            const posts = getPosts();
            const post = posts.find(p => p.id === postId);
            
            if (post) {
                if (!post.likedBy) post.likedBy = [];
                
                if (post.likedBy.includes(user.id)) {
                    // Unlike
                    post.likedBy = post.likedBy.filter(id => id !== user.id);
                    post.likes = (post.likes || 1) - 1;
                } else {
                    // Like
                    post.likedBy.push(user.id);
                    post.likes = (post.likes || 0) + 1;
                    
                    // Create notification
                    createNotification('like', user, post);
                }
                
                savePosts(posts);
                loadFeed();
            }
        }

        function focusComment(postId) {
            const commentsDiv = document.getElementById(`comments-${postId}`);
            if (commentsDiv) {
                commentsDiv.style.display = commentsDiv.style.display === 'none' ? 'block' : 'none';
                if (commentsDiv.style.display === 'block') {
                    setTimeout(() => {
                        document.getElementById(`comment-input-${postId}`)?.focus();
                    }, 100);
                }
            }
        }

        function handleCommentKeyPress(event, postId) {
            if (event.key === 'Enter') {
                addComment(postId);
            }
        }

        function addComment(postId) {
            const user = getCurrentUser();
            if (!user) {
                showToast('Please login to comment', 'warning');
                showLoginPage();
                return;
            }
            
            const input = document.getElementById(`comment-input-${postId}`);
            const text = input.value.trim();
            
            if (!text) {
                showToast('Please write a comment', 'warning');
                return;
            }
            
            const posts = getPosts();
            const post = posts.find(p => p.id === postId);
            
            if (post) {
                if (!post.comments) post.comments = [];
                
                post.comments.push({
                    id: Date.now(),
                    userId: user.id,
                    userName: user.fullName || `${user.firstName} ${user.lastName}`,
                    userAvatar: user.avatar || 'https://via.placeholder.com/35',
                    text: text,
                    timestamp: new Date().toISOString()
                });
                
                savePosts(posts);
                input.value = '';
                
                // Create notification
                createNotification('comment', user, post, text);
                
                loadFeed();
                showToast('Comment added!', 'success');
            }
        }

        function sharePost(postId) {
            showToast('Share functionality coming soon!', 'info');
        }

        // ======================
        // NOTIFICATION FUNCTIONS
        // ======================
        
        function getNotifications() {
            return JSON.parse(localStorage.getItem('social_notifications')) || [];
        }

        function saveNotifications(notifications) {
            localStorage.setItem('social_notifications', JSON.stringify(notifications));
        }

        function createNotification(type, user, post, commentText = null) {
            const notifications = getNotifications();
            
            const notification = {
                id: Date.now(),
                type: type,
                userId: user.id,
                userName: user.fullName || `${user.firstName} ${user.lastName}`,
                userAvatar: user.avatar || 'https://via.placeholder.com/40',
                postId: post.id,
                postContent: post.content.substring(0, 50) + '...',
                comment: commentText,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            notifications.push(notification);
            saveNotifications(notifications);
            updateNotificationBadge();
        }

        function updateNotificationBadge() {
            const notifications = getNotifications();
            const unread = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            
            if (badge) {
                if (unread > 0) {
                    badge.textContent = unread > 9 ? '9+' : unread;
                    badge.classList.remove('d-none');
                } else {
                    badge.classList.add('d-none');
                }
            }
        }

        function loadNotifications() {
            const notifications = getNotifications();
            const container = document.getElementById('notificationsContainer');
            
            if (notifications.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-bell fa-4x text-muted mb-3"></i>
                        <h5>No notifications yet</h5>
                        <p class="text-muted">When you get notifications, they'll appear here</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            notifications.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            notifications.forEach(notification => {
                let message = '';
                let icon = '';
                
                switch(notification.type) {
                    case 'like':
                        icon = 'fa-heart text-danger';
                        message = `<strong>${notification.userName}</strong> liked your post: "${notification.postContent}"`;
                        break;
                    case 'comment':
                        icon = 'fa-comment text-primary';
                        message = `<strong>${notification.userName}</strong> commented on your post: "${notification.comment}"`;
                        break;
                    case 'follow':
                        icon = 'fa-user-plus text-success';
                        message = `<strong>${notification.userName}</strong> started following you`;
                        break;
                }
                
                html += `
                    <div class="d-flex align-items-start p-3 ${!notification.read ? 'bg-light' : ''} border-bottom">
                        <div class="me-3">
                            <img src="${notification.userAvatar}" class="profile-avatar" alt="Avatar">
                        </div>
                        <div class="flex-grow-1">
                            <p class="mb-1">${message}</p>
                            <small class="text-muted">${formatDate(notification.timestamp)}</small>
                        </div>
                        ${!notification.read ? '<span class="badge bg-primary ms-2">New</span>' : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Mark all as read when viewed
            notifications.forEach(n => n.read = true);
            saveNotifications(notifications);
            updateNotificationBadge();
        }

        function markAllNotificationsRead() {
            const notifications = getNotifications();
            notifications.forEach(n => n.read = true);
            saveNotifications(notifications);
            loadNotifications();
            updateNotificationBadge();
            showToast('All notifications marked as read', 'success');
        }

        // ======================
        // PROFILE FUNCTIONS
        // ======================
        
        function loadProfile() {
            const user = getCurrentUser();
            if (!user) {
                showLoginPage();
                return;
            }
            
            // Update profile header
            document.getElementById('profileAvatar').src = user.avatar || 'https://via.placeholder.com/150';
            document.getElementById('profileFullName').textContent = user.fullName || `${user.firstName} ${user.lastName}`;
            document.getElementById('profileUserBio').textContent = user.bio || 'Welcome to SocialHub!';
            document.getElementById('profileLocation').innerHTML = `<i class="fas fa-map-marker-alt me-2"></i> ${user.location || 'Location not set'} <span class="ms-3"><i class="fas fa-calendar-alt me-2"></i> Joined ${user.joined || '2024'}</span>`;
            
            document.getElementById('profileAbout').textContent = user.bio || 'Passionate developer currently interning at CodeAlpha.';
            document.getElementById('profileWork').textContent = user.work || 'Not specified';
            document.getElementById('profileEducation').textContent = user.education || 'Not specified';
            document.getElementById('profileHobbies').textContent = user.hobbies || 'Not specified';
            
            // Load user posts
            const posts = getPosts();
            const userPosts = posts.filter(p => p.userId === user.id).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            document.getElementById('profilePostCount').textContent = userPosts.length;
            
            const userPostsContainer = document.getElementById('userPostsContainer');
            if (userPosts.length === 0) {
                userPostsContainer.innerHTML = '<p class="text-muted text-center py-4">No posts yet</p>';
            } else {
                let html = '';
                userPosts.forEach(post => {
                    html += `
                        <div class="post-card">
                            <div class="post-header">
                                <img src="${post.userAvatar}" class="post-avatar" alt="Avatar">
                                <div>
                                    <h6 class="mb-0">${post.userName}</h6>
                                    <small class="text-muted">${formatDate(post.timestamp)}</small>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>${post.content}</p>
                                ${post.image ? `<img src="${post.image}" class="post-image" alt="Post">` : ''}
                            </div>
                        </div>
                    `;
                });
                userPostsContainer.innerHTML = html;
            }
            
            // Load followers/following counts
            const followers = getFollowers(user.id);
            const following = getFollowing(user.id);
            document.getElementById('profileFollowerCount').textContent = formatNumber(followers.length);
            document.getElementById('profileFollowingCount').textContent = formatNumber(following.length);
        }

        function loadProfileEdit() {
            const user = getCurrentUser();
            if (!user) {
                showLoginPage();
                return;
            }
            
            document.getElementById('editAvatar').src = user.avatar || 'https://via.placeholder.com/120';
            document.getElementById('editFirstName').value = user.firstName || '';
            document.getElementById('editLastName').value = user.lastName || '';
            document.getElementById('editBio').value = user.bio || '';
            document.getElementById('editLocation').value = user.location || '';
            document.getElementById('editWork').value = user.work || '';
            document.getElementById('editEducation').value = user.education || '';
            document.getElementById('editHobbies').value = user.hobbies || '';
            document.getElementById('editEmail').value = user.email || '';
        }

        function updateAvatarPreview(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('editAvatar').src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function shareProfile() {
            showToast('Share profile feature coming soon!', 'info');
        }

        // ======================
        // FOLLOW FUNCTIONS
        // ======================
        
        function getFollowers(userId) {
            const followers = JSON.parse(localStorage.getItem('social_followers')) || {};
            return followers[userId] || [];
        }

        function getFollowing(userId) {
            const following = JSON.parse(localStorage.getItem('social_following')) || {};
            return following[userId] || [];
        }

        function followUser(targetUserId) {
            const user = getCurrentUser();
            if (!user) {
                showToast('Please login to follow users', 'warning');
                showLoginPage();
                return;
            }
            
            if (user.id === targetUserId) {
                showToast('You cannot follow yourself', 'warning');
                return;
            }
            
            // Update following list for current user
            const following = JSON.parse(localStorage.getItem('social_following')) || {};
            if (!following[user.id]) following[user.id] = [];
            
            if (!following[user.id].includes(targetUserId)) {
                following[user.id].push(targetUserId);
                localStorage.setItem('social_following', JSON.stringify(following));
                
                // Update followers list for target user
                const followers = JSON.parse(localStorage.getItem('social_followers')) || {};
                if (!followers[targetUserId]) followers[targetUserId] = [];
                
                if (!followers[targetUserId].includes(user.id)) {
                    followers[targetUserId].push(user.id);
                    localStorage.setItem('social_followers', JSON.stringify(followers));
                }
                
                // Create notification
                const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
                const targetUser = users.find(u => u.id === targetUserId);
                
                if (targetUser) {
                    const notifications = getNotifications();
                    notifications.push({
                        id: Date.now(),
                        type: 'follow',
                        userId: user.id,
                        userName: user.fullName || `${user.firstName} ${user.lastName}`,
                        userAvatar: user.avatar || 'https://via.placeholder.com/40',
                        timestamp: new Date().toISOString(),
                        read: false
                    });
                    saveNotifications(notifications);
                }
                
                showToast('User followed successfully!', 'success');
                loadSuggestedFriends();
            }
        }

        function unfollowUser(targetUserId) {
            const user = getCurrentUser();
            if (!user) return;
            
            const following = JSON.parse(localStorage.getItem('social_following')) || {};
            if (following[user.id]) {
                following[user.id] = following[user.id].filter(id => id !== targetUserId);
                localStorage.setItem('social_following', JSON.stringify(following));
            }
            
            const followers = JSON.parse(localStorage.getItem('social_followers')) || {};
            if (followers[targetUserId]) {
                followers[targetUserId] = followers[targetUserId].filter(id => id !== user.id);
                localStorage.setItem('social_followers', JSON.stringify(followers));
            }
            
            showToast('User unfollowed', 'success');
            loadSuggestedFriends();
        }

        function loadSuggestedFriends() {
            const container = document.getElementById('suggestedFriends');
            const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
            const currentUser = getCurrentUser();
            
            if (!currentUser) {
                container.innerHTML = '<p class="text-muted text-center">Login to see suggestions</p>';
                return;
            }
            
            // Filter out current user and already following
            const following = getFollowing(currentUser?.id || 0);
            const suggested = users.filter(u => 
                u.id !== currentUser?.id && 
                !following.includes(u.id)
            ).slice(0, 3);
            
            if (suggested.length === 0) {
                container.innerHTML = '<p class="text-muted text-center">No suggestions</p>';
                return;
            }
            
            let html = '';
            suggested.forEach(user => {
                html += `
                    <div class="friend-item">
                        <img src="${user.avatar || 'https://via.placeholder.com/45'}" class="friend-avatar" alt="${user.fullName}">
                        <div class="friend-info">
                            <div class="friend-name">${user.fullName || `${user.firstName} ${user.lastName}`}</div>
                            <div class="friend-mutual">${user.bio?.substring(0, 20) || 'New user'}</div>
                        </div>
                        <button class="btn btn-sm btn-primary follow-btn" onclick="followUser(${user.id})">
                            Follow
                        </button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // ======================
        // EXPLORE FUNCTIONS
        // ======================
        
        function loadExplore() {
            const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
            const currentUser = getCurrentUser();
            const exploreUsers = document.getElementById('exploreUsers');
            
            let userHtml = '';
            users.filter(u => u.id !== currentUser?.id).slice(0, 6).forEach(user => {
                userHtml += `
                    <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-center">
                            <img src="${user.avatar || 'https://via.placeholder.com/60'}" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover;" class="me-3">
                            <div>
                                <h6 class="mb-1">${user.fullName || `${user.firstName} ${user.lastName}`}</h6>
                                <small class="text-muted">${user.bio?.substring(0, 30) || 'No bio'}</small>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-primary" onclick="followUser(${user.id})">
                                        <i class="fas fa-user-plus me-1"></i> Follow
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            exploreUsers.innerHTML = userHtml;
            
            // Load explore posts
            const posts = getPosts();
            const explorePosts = document.getElementById('explorePosts');
            let postHtml = '';
            
            posts.slice(0, 3).forEach(post => {
                postHtml += `
                    <div class="d-flex align-items-start mb-3">
                        <img src="${post.userAvatar}" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;" class="me-3">
                        <div>
                            <h6 class="mb-1">${post.userName}</h6>
                            <p class="mb-1">${post.content.substring(0, 100)}...</p>
                            <small class="text-muted">${post.likes || 0} likes · ${post.comments?.length || 0} comments</small>
                        </div>
                    </div>
                `;
            });
            
            explorePosts.innerHTML = postHtml;
        }

        // ======================
        // MESSAGES FUNCTIONS
        // ======================
        
        function loadMessages() {
            const messages = JSON.parse(localStorage.getItem('social_messages')) || sampleMessages;
            const container = document.getElementById('conversationsList');
            
            let html = '';
            messages.forEach(msg => {
                html += `
                    <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="openConversation(${msg.userId})">
                        <div class="position-relative">
                            <img src="${msg.userAvatar}" class="profile-avatar me-3" alt="${msg.userName}">
                            ${msg.unread > 0 ? '<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + msg.unread + '</span>' : ''}
                        </div>
                        <div class="flex-grow-1">
                            <div class="d-flex justify-content-between">
                                <h6 class="mb-0">${msg.userName}</h6>
                                <small class="text-muted">${formatDate(msg.timestamp)}</small>
                            </div>
                            <small class="text-muted">${msg.lastMessage}</small>
                        </div>
                    </a>
                `;
            });
            
            container.innerHTML = html;
        }

        function openConversation(userId) {
            showToast('Messaging feature coming soon!', 'info');
        }

        // ======================
        // SEARCH FUNCTIONS
        // ======================
        
        function searchGlobal(event) {
            if (event.key === 'Enter') {
                const query = document.getElementById('searchInput').value.trim();
                if (query) {
                    document.getElementById('searchQuery').textContent = query;
                    showPage('searchResults');
                    
                    // Search users
                    const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
                    const userResults = users.filter(u => 
                        u.fullName?.toLowerCase().includes(query.toLowerCase()) ||
                        u.firstName?.toLowerCase().includes(query.toLowerCase()) ||
                        u.lastName?.toLowerCase().includes(query.toLowerCase()) ||
                        u.bio?.toLowerCase().includes(query.toLowerCase())
                    );
                    
                    const peopleContainer = document.getElementById('searchPeopleResults');
                    if (userResults.length === 0) {
                        peopleContainer.innerHTML = '<p class="text-muted">No users found</p>';
                    } else {
                        let html = '';
                        userResults.forEach(user => {
                            html += `
                                <div class="d-flex align-items-center mb-3">
                                    <img src="${user.avatar || 'https://via.placeholder.com/50'}" class="profile-avatar me-3">
                                    <div>
                                        <h6 class="mb-0">${user.fullName || `${user.firstName} ${user.lastName}`}</h6>
                                        <small class="text-muted">${user.bio?.substring(0, 50) || 'No bio'}</small>
                                    </div>
                                </div>
                            `;
                        });
                        peopleContainer.innerHTML = html;
                    }
                    
                    // Search posts
                    const posts = getPosts();
                    const postResults = posts.filter(p => 
                        p.content.toLowerCase().includes(query.toLowerCase())
                    );
                    
                    const postsContainer = document.getElementById('searchPostsResults');
                    if (postResults.length === 0) {
                        postsContainer.innerHTML = '<p class="text-muted">No posts found</p>';
                    } else {
                        let html = '';
                        postResults.slice(0, 5).forEach(post => {
                            html += `
                                <div class="d-flex align-items-start mb-3">
                                    <img src="${post.userAvatar}" class="profile-avatar me-3">
                                    <div>
                                        <h6 class="mb-1">${post.userName}</h6>
                                        <p class="mb-1">${post.content.substring(0, 100)}...</p>
                                        <small class="text-muted">${formatDate(post.timestamp)}</small>
                                    </div>
                                </div>
                            `;
                        });
                        postsContainer.innerHTML = html;
                    }
                }
            }
        }

        // ======================
        // FORM HANDLERS
        // ======================
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeStorage();
            
            // Setup login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const email = document.getElementById('loginEmail').value;
                    const password = document.getElementById('loginPassword').value;
                    login(email, password);
                });
            }
            
            // Setup create account form
            const createAccountForm = document.getElementById('createAccountForm');
            if (createAccountForm) {
                createAccountForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const firstName = document.getElementById('newFirstName').value.trim();
                    const lastName = document.getElementById('newLastName').value.trim();
                    const email = document.getElementById('newEmail').value.trim();
                    const password = document.getElementById('newPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    // Validation
                    if (!firstName || !lastName || !email || !password) {
                        showToast('Please fill all fields', 'warning');
                        return;
                    }
                    
                    if (password.length < 6) {
                        showToast('Password must be at least 6 characters', 'warning');
                        return;
                    }
                    
                    if (password !== confirmPassword) {
                        showToast('Passwords do not match', 'warning');
                        return;
                    }
                    
                    if (!email.includes('@') || !email.includes('.')) {
                        showToast('Please enter a valid email', 'warning');
                        return;
                    }
                    
                    createNewAccount(firstName, lastName, email, password);
                });
            }
            
            // Setup profile edit form
            const profileEditForm = document.getElementById('profileEditForm');
            if (profileEditForm) {
                profileEditForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const user = getCurrentUser();
                    if (user) {
                        // Update user data
                        user.firstName = document.getElementById('editFirstName').value;
                        user.lastName = document.getElementById('editLastName').value;
                        user.fullName = `${user.firstName} ${user.lastName}`;
                        user.bio = document.getElementById('editBio').value;
                        user.location = document.getElementById('editLocation').value;
                        user.work = document.getElementById('editWork').value;
                        user.education = document.getElementById('editEducation').value;
                        user.hobbies = document.getElementById('editHobbies').value;
                        user.avatar = document.getElementById('editAvatar').src;
                        
                        localStorage.setItem('social_currentUser', JSON.stringify(user));
                        
                        // Update in users list
                        const users = JSON.parse(localStorage.getItem('social_users')) || sampleUsers;
                        const userIndex = users.findIndex(u => u.id === user.id);
                        if (userIndex !== -1) {
                            users[userIndex] = { ...users[userIndex], ...user };
                            localStorage.setItem('social_users', JSON.stringify(users));
                        }
                        
                        showToast('Profile updated successfully!', 'success');
                        updateUserMenu();
                        showPage('profile');
                    }
                });
            }
            
            // Load initial data
            updateUserMenu();
            loadSuggestedFriends();
            loadFeed();
            updateNotificationBadge();
        });
    </script>
</body>
</html>
